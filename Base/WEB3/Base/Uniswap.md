## ğŸ§  ä¸€ã€å…³é”®è¯è§£é‡Š
### 1. **è°ƒ ABI è¯¢ä»·**
- ABIï¼ˆApplication Binary Interfaceï¼‰æ˜¯åˆçº¦è°ƒç”¨çš„æ¥å£å®šä¹‰ï¼Œç”¨äºå’Œ Uniswap åˆçº¦äº¤äº’ã€‚
- ä½ å¯ä»¥è°ƒç”¨ `getAmountsOut`ï¼ˆV2ï¼‰æˆ– `quoteExactInputSingle`ï¼ˆV3ï¼‰æ¥æ¨¡æ‹ŸæŠ¥ä»·ï¼Œå³ï¼šç»™ä¸€ä¸ª tokenIn æ•°é‡ï¼ŒæŸ¥è¯¢èƒ½æ¢å¤šå°‘ tokenOutã€‚
### 2. **è§£æäº‹ä»¶ï¼ˆEventï¼‰**
- Swap å‘ç”Ÿæ—¶åˆçº¦ä¼š emit äº‹ä»¶ï¼Œä¾‹å¦‚ `Swap(address sender, ...)`ã€‚
- ä½ ç›‘å¬äº‹ä»¶æ—¥å¿—ï¼ˆlogsï¼‰ï¼Œå¯ä»¥è·çŸ¥æ¯ç¬”äº¤æ˜“çš„è¯¦æƒ…ï¼Œå¦‚è°æ¢äº†å¤šå°‘ tokenã€æ¢æˆäº†ä»€ä¹ˆç­‰ã€‚
### 3. **å•è·³è·¯å¾„ï¼ˆSingle Hop Swapï¼‰**
- åªç»è¿‡ä¸€ä¸ªäº¤æ˜“æ± ï¼ˆtokenA â†” tokenBï¼‰ï¼Œè€Œéå¤šä¸ªæ± ï¼ˆtokenA â†’ tokenB â†’ tokenCï¼‰ã€‚
- ä½¿ç”¨ V2 `swapExactTokensForTokens` æˆ– V3 çš„ `exactInputSingle` æ–¹æ³•ã€‚
### 4. **LPï¼ˆLiquidity Providerï¼‰**
- æä¾›æµåŠ¨æ€§çš„ç”¨æˆ·ï¼Œå°† tokenA å’Œ tokenB å­˜å…¥æ± å­ï¼Œæ¢å¾— LP tokenã€‚
- ä½ çš„ swap ä¼šç”¨åˆ°ä»–ä»¬æä¾›çš„æµåŠ¨æ€§ï¼Œæ‰‹ç»­è´¹ä¼šåˆ†ç»™ LPã€‚
### 5. **æ·±åº¦ï¼ˆLiquidity Depthï¼‰**
- è¡¨ç¤ºä¸€ä¸ªäº¤æ˜“æ± ä¸­ token çš„æ•°é‡å’Œåˆ†å¸ƒã€‚
- æ·±åº¦è¶Šå¤§ï¼Œæ»‘ç‚¹è¶Šå°ï¼Œå½±å“æŠ¥ä»·çš„ç¨³å®šæ€§ã€‚
### 6. **Tick**
- V3 å¼•å…¥çš„ä»·æ ¼åˆ»åº¦å•ä½ã€‚
- æ± å­çš„ä»·æ ¼èŒƒå›´è¢«åˆ’åˆ†ä¸º ticksï¼Œä¾‹å¦‚ä¸€ä¸ª tick è¡¨ç¤º 1.0001 çš„å€ç‡ã€‚
- ä½ å¯ä»¥é€šè¿‡ tick æ¥åˆ¤æ–­å½“å‰ä»·æ ¼ã€æ´»è·ƒæµåŠ¨æ€§ç­‰ã€‚
### 7. **ä»·æ ¼å’Œæ•°é‡å¯¹æ¯”**
- æ¯”å¦‚ä½ ç”¨ 1 ETH èƒ½æ¢å¤šå°‘ USDCï¼Œå¯¹æ¯”é“¾ä¸Šçš„æŠ¥ä»·ä¸å®é™…æˆäº¤ä»·æ˜¯å¦åˆç†ã€‚
- å¯ç”¨äºå¥—åˆ©ç›‘æµ‹ã€æ»‘ç‚¹åˆ†æã€‚
### 8. **Router**
> å°è£…äº†å¸¸è§çš„äº¤æ˜“è·¯å¾„ä¸æµåŠ¨æ€§æ·»åŠ /ç§»é™¤çš„æ“ä½œé€»è¾‘ã€‚å•è·³ã€å¤šè·³ token å…‘æ¢,æ·»åŠ æˆ–ç§»é™¤ LP æµåŠ¨æ€§, æ”¯æŒ WETH â†” ETH çš„åŒ…è£…/è§£åŒ…

**Routerï¼ˆè·¯ç”±å™¨åˆçº¦ï¼‰** æ˜¯ç”¨æ¥çœŸæ­£æ‰§è¡Œäº¤æ˜“ï¼ˆswapï¼‰çš„åˆçº¦ã€‚å®ƒä¼šè‡ªåŠ¨å¯»æ‰¾æœ€ä½³è·¯å¾„æ¥å…‘æ¢ï¼Œæ¯”å¦‚ï¼š
- å•è·³ï¼šWETH â†’ USDC
- å¤šè·³ï¼šWETH â†’ DAI â†’ USDC

ä¸åŒç‰ˆæœ¬çš„ Routerï¼š

|ç‰ˆæœ¬|Router åœ°å€|ä½œç”¨|
|---|---|---|
|V2|`0x7a250d...`|ç®€å• token â†” token äº¤æ¢|
|V3|`0xE59242...`|æ›´å¤æ‚ï¼Œæ”¯æŒ tickã€å•è·³ã€å¤šè·³è·¯å¾„äº¤æ¢|

ğŸ‘‰ åœ¨ **æ¨¡æ‹ŸæŠ¥ä»·** æ—¶æˆ‘ä»¬è°ƒç”¨çš„æ˜¯ **Quoter** åˆçº¦  
ğŸ‘‰ åœ¨ **çœŸå®ä¸‹å•äº¤æ˜“** æ—¶ä¼šè°ƒç”¨ **Router** åˆçº¦

## äºŒã€å®æˆ˜å­¦ä¹ è·¯çº¿

### âœ… Step 1ï¼šåŸºç¡€äº†è§£ä¸å®˜æ–¹èµ„æº

|å†…å®¹|æ¨èèµ„æº|
|---|---|
|Uniswap V2 & V3 ç™½çš®ä¹¦|https://uniswap.org/whitepaper|
|Uniswap V3 Core Docs|https://docs.uniswap.org/|
|ABI æ¥å£æ–‡æ¡£|https://docs.uniswap.org/reference/contracts|

---

### âœ… Step 2ï¼šåˆçº¦äº¤äº’ä¸æŠ¥ä»·ï¼ˆæ¨¡æ‹Ÿäº¤æ˜“ï¼‰

1. äº†è§£ V2/V3 åˆçº¦åœ°å€ï¼šRouter å’Œ Pool
    - V2 Routerï¼š`0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D`
    - V3 Routerï¼š`0xE592427A0AEce92De3Edee1F18E0157C05861564`
2. ä½¿ç”¨è„šæœ¬æˆ– Ethers.js/Web3.jsï¼š
    - `getAmountsOut(amountIn, path)`ï¼ˆV2ï¼‰
    - `quoteExactInputSingle`ï¼ˆV3ï¼‰
3. å·¥å…·æ¨èï¼š
    - Ethers.jsï¼ˆæ¨èï¼‰
    - Viemï¼ˆè½»é‡æ–°åº“ï¼‰
    - Hardhat + Alchemy/Infura/Ankr èŠ‚ç‚¹
---

### âœ… Step 3ï¼šç›‘å¬äº‹ä»¶ï¼ˆè§£æ swapï¼‰

1. ä½¿ç”¨ Ethers.js æˆ– Web3.js `contract.on("Swap", callback)`
2. æˆ–è€…è§£æå†å² logsï¼š
   ```js
		provider.getLogs({
		  address: poolAddress,
		  topics: [swapTopicHash],
		  fromBlock,
		  toBlock
		})
     ```
3. åˆ†æå­—æ®µï¼š
    - sender, recipient, amount0/1In/Out
    - å¯ä»¥è®¡ç®— token ä»·æ ¼å˜åŒ–ã€swap æˆæœ¬ç­‰

---

### âœ… Step 4ï¼šç†è§£æ·±åº¦ã€LPã€Tickï¼ˆUniswap V3ï¼‰

1. ä½¿ç”¨ GraphQL/Uniswap Subgraphï¼š
    - https://thegraph.com/explorer/subgraph/uniswap/uniswap-v3
2. å…³é”®å­—æ®µï¼š
    - `liquidity`ï¼šå½“å‰æ± å­æ·±åº¦
    - `tick`ï¼šå½“å‰ tick index
    - `sqrtPriceX96`ï¼šä»·æ ¼æ ¹å·ï¼Œè®¡ç®—çœŸå®ä»·æ ¼ç”¨
3. Tick ä»·æ ¼æ¢ç®—å…¬å¼ï¼š
    `price = 1.0001 ^ tick`

---

### âœ… Step 5ï¼šæ„å»ºä½ è‡ªå·±çš„è„šæœ¬/åº”ç”¨

ç›®æ ‡ç¤ºä¾‹ï¼š
- è·å– ETH â†’ USDC swap æŠ¥ä»·ï¼ˆV2 å’Œ V3 å¯¹æ¯”ï¼‰
- ç›‘å¬æŸäº¤æ˜“å¯¹çš„å®æ—¶äº¤æ˜“äº‹ä»¶
- åˆ†ææŸæ± å½“å‰ tickã€æ·±åº¦ã€æ´»è·ƒ LP åŒºé—´
- æ¨¡æ‹Ÿä¸€ç¬”äº¤æ˜“ï¼Œè®°å½•å…¶æ»‘ç‚¹ä¸çœŸå®ä»·æ ¼

---

## âš’ï¸ å·¥å…·æ¨è

|å·¥å…·|ç”¨é€”|
|---|---|
|Alchemy / Infura|RPC èŠ‚ç‚¹|
|Ethers.js|JS åˆçº¦äº¤äº’|
|Foundry / Hardhat|æµ‹è¯•åˆçº¦è°ƒç”¨|
|The Graph|è·å– LPã€tick æ•°æ®|
|Tenderly|äº‹åŠ¡è°ƒè¯•ã€æ¨¡æ‹Ÿ|
|Uniswap V3 SDK|äº¤æ˜“è·¯å¾„è§„åˆ’ã€tick æ¨¡æ‹Ÿ|
